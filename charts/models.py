from django.db import models


class Vulnerability(models.Model):
    cve_id = models.CharField(max_length=30, unique=True)
    name = models.TextField()
    code = models.IntegerField()
    score = models.FloatField()
    access_authentication = models.TextField()
    access_complexity = models.TextField()
    access_vector = models.TextField()
    impact_availability = models.TextField()
    impact_confidentiality = models.TextField()
    impact_integrity = models.TextField()
    date_modified = models.DateField()
    date_created = models.DateField()


class Attack(models.Model):
    category = models.CharField(db_index=True, max_length=30)
    subcategory = models.CharField(db_index=True, max_length=60)
    protocol = models.CharField(db_index=True, max_length=20)
    source_ip = models.CharField(max_length=15)
    source_port = models.IntegerField()
    destination_ip = models.CharField(max_length=15)
    destination_port = models.IntegerField()
    date_modified = models.DateField()
    date_created = models.DateField()

    class Meta:
        indexes = [
            models.Index(fields=['category', 'protocol']),
        ]


class Breach(models.Model):
    entity = models.TextField()
    state = models.CharField(max_length=2)
    individuals_affected = models.IntegerField(db_index=True)
    breach_type = models.TextField(db_index=True)
    location_of_breached_info = models.TextField()
    date_modified = models.DateField()
    date_created = models.DateField(db_index=True)
